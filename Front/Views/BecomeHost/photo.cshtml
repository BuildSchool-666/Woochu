

<div class="d-flex">
    <div class="left">
        <video autoplay controls muted loop class="video" style="object-fit: cover; object-position:center top;">
            <source src="https://a0.muscache.com/v/d6/12/d6120feb-75fc-52dd-b5bb-5755913fb756/d6120feb75fc52ddb5bb5755913fb756_4000k_1.mp4"
                    type="video/mp4" style="box-sizing: border-box;" playsinline preload="auto">
        </video>
        <h1><strong>接下來，請爲房源新增幾張相片</strong></h1>
    </div>
    <div class="right">
        <div class="d-flex">
            <div class="btngroup">
                <a href="~/BecomeHost/Index" class="btn-h"><strong>退出</strong></a>
            </div>

            <div class="photoarea" id="photoarea">
                <label id="uploadLabel" for="file-upload" type="button" class="fill">從你的裝置上傳</label>
                <input v-on:change="ToUrl()" class="d-none" id="file-upload" type="file" accept="image/*" multiple>
                <div id="upload_zone" class="upload_zone">
                    <svg class="upload_icon" xmlns="http://www.w3.org/2000/svg" width="64px" height="64px" fill="currentColor"
                         class="bi bi-card-image" viewBox="0 0 16 16">
                        <path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z" />
                        <path d="M1.5 2A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13zm13 1a.5.5 0 0 1 .5.5v6l-3.775-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12v.54A.505.505 0 0 1 1 12.5v-9a.5.5 0 0 1 .5-.5h13z" />
                    </svg>
                    <p class="text">請新增 5 張相片</p>
                    <div id="preview"></div>
                </div>
            </div>


            <div class="last-bar">
                <a href="~/BecomeHost/amenities" class="back"><strong>返回</strong></a>
                <button v-on:click="Clear()" id="reset" type="button">清空照片</button>
                <button v-on:click="Next()" type="button" class="next text-white" :disabled="checked" :style="checkedStyle" id="next">下一步</button>
            </div>
        </div>
    </div>
</div>



@section TopCSS{
    <style>
        #reset {
            display: flex;
            margin: auto;
            width: 40%;
            font-size: 18px;
            font-weight: 150px;
            letter-spacing: 1px;
            padding: 13px 50px 13px;
            outline: 0;
            border: 1px solid black;
            cursor: pointer;
            position: relative;
            background-color: rgba(0, 0, 0, 0);
            justify-content: center;
        }

        #reset:after {
            content: "";
            background-color: rgb(244, 244, 72);
            width: 100%;
            z-index: -1;
            position: absolute;
            height: 100%;
            top: 7px;
            left: 7px;
            transition: 0.2s;
        }

        #reset:hover::after {
            top: 0px;
            left: 0px;
        }
        /* Fill button styling */
        .fill {
            display: flex;
            margin: auto;
            width: 80%;
            font-size: 20px;
            font-weight: 200px;
            letter-spacing: 1px;
            padding: 13px 50px 13px;
            outline: 0;
            border: 1px solid black;
            cursor: pointer;
            position: relative;
            background-color: rgba(0, 0, 0, 0);
            justify-content: center;
        }

        .fill::after {
            content: "";
            background-color: #ff385c;
            width: 100%;
            z-index: -1;
            position: absolute;
            height: 100%;
            top: 7px;
            left: 7px;
            transition: 0.2s;
        }

        .fill:hover::after {
            top: 0px;
            left: 0px;
        }

        /* End of Fill Button  */

        .video {
            display: block;
            height: 100vh;
            width: 100%;
            position: fixed;
            top: -30vh;
            box-sizing: border-box;
        }

        h1 {
            position: relative;
            top: -70vh;
            padding: 10px;
            font-size: 48px;
            color: white;
        }

        .right {
            width: 100%;
            height: 60vh;
            position: fixed;
            right: 0;
            bottom: -20vh;
            overflow: scroll;
            background-color: white;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
        }

        ::-webkit-scrollbar {
            width: 0px;
        }


        .btngroup {
            width: 100%;
            position: fixed;
            top: 0;
            right: -50%;
            background-color: transparent;
            padding-top: 20px;
            /* padding-bottom: 20px; */
            justify-content: flex-end;
            z-index: 0;
        }

        .btn-h {
            text-decoration: none;
            color: black;
            width: 20%;
            background-color: #F0F0F0;
            border-radius: 20px;
            border: none;
            margin: 10px;
            padding: 5px 10px;
            transition-duration: 1s;
            font-size: 10px;
        }

        .btn-h:hover {
            color: white;
            background-color: red;
        }

        .last-bar {
            position: fixed;
            width: 100%;
            right: 0;
            bottom: 0;
            background-color: white;
            padding: 20px;
            border-top: 2px solid #F0F0F0;
            display: flex;
            justify-content: space-between;
        }

        .back {
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            color: white;
            width: 20vh;
            position: relative;
            top: 0;
            left: 0;
            border-radius: 10px;
            background-color: #D0D0D0;
            border: none;
            transition-duration: 1s;
        }

        .back:hover {
            background-color: black;
            color: white;
        }

        .next {
            position: relative;
            right: 0;
            top: 0;
            padding: 10px 15px;
            width: 20vh;
            border-radius: 10px;
            border: none;
            background-color: #D0D0D0;
            transition-duration: 1s;
        }

        .photoarea {
            position: relative;
            top: -200px;
            margin-left: 50px;
            width: 80%;
            height: 70vh;
            overflow-y: scroll;
        }

        .upload_zone {
            text-align: center;
            justify-content: center;
            padding-top: 20%;
            border: 1px dashed black;
            width: 100%;
            height: 80vh;
        }

        .upload_zone_enter {
            border: 3px dashed black;
            background-clip: content-box;
        }

        .text {
            font-size: 22px;
            letter-spacing: -0.02em;
            line-height: 20px;
            margin-top: 15px;
        }

        .obj {
            width: 100%;
            height: 100vh;
        }

        #preview {
            margin-left: 25%;
            width: 50%;
        }
    </style>
    <style media="screen and (min-width:744px)">
        .left {
            float: left;
            width: 50%;
            height: 100vh;
        }

        .video {
            float: left;
            position: relative;
            top: 0;
        }

        h1 {
            top: -45vh;
        }

        .right {
            width: 50%;
            height: 100vh;
            bottom: 0;
        }

        .btngroup {
            right: -25%;
            width: 50%;
            background-color: white;
        }

        .btn-h {
            height: 35px;
            padding: 5px 15px;
        }

        .last-bar {
            width: 50%;
        }

        .photoarea {
            position: fixed;
            top: 10vh;
            width: 40%;
        }
    </style>
}

@section EndJS{
    <script>
        let app = new Vue({
            el: '.right',
            data: {
                cloudinaryKey: [],
                checked: true,
                index: 0,
                imgList: [],
            },
            mounted() {
                document.addEventListener('DOMContentLoaded', function () {
                    axios.get('/api/PublishRoomAPI/GetCloudinary')
                        .then((res) => {
                            if (res.data.status === 20000) {
                                app.cloudinaryKey = res.data.result
                            }
                        })
                });
            },
            computed: {
                checkedStyle() {
                    return {
                        backgroundColor: this.checked ? '#D0D0D0' : 'black',
                    }
                }
            },
            methods: {
                Check() {
                    const files = document.querySelector("[type=file]").files;
                    this.checked = files[0].length != 0 ? false : true;
                },
                Next() {
                    var roomImg = { 'roomImgs': this.imgList }
                    sessionStorage['roomImg'] = JSON.stringify(roomImg)
                    window.location = 'title';
                },
               ToUrl() {
                    const files = document.querySelector("[type=file]").files;
                    var ii = this.index;
                    for (var i = 0; i < files.length; i++) {
                        const formData = new FormData();

                        ii++;
                        document.querySelector(".text").style.display = "none";
                        document.querySelector(".upload_icon").style.display = "none";
                        let file = files[i];
                        formData.append("file", file);
                        formData.append("upload_preset", app.cloudinaryKey.cloudinarY_UPLOAD_PRESET);

                        axios.post(app.cloudinaryKey.cloudinarY_URL, formData)
                            .then((res) => {
                                console.log(res.data.secure_url);
                                var img = document.getElementById('preview').appendChild(document.createElement('img'));
                                img.id = ii;
                                img.src = res.data.secure_url;
                                img.style.maxWidth = '150%'
                                this.imgList.push(res.data.secure_url);

                            })
                    }
                    this.index = ii;
                    this.Check();
                },
                Clear() {
                    this.imgList = [];
                    document.getElementById('preview').innerHTML = '';
                    this.checked = true;
                },
            }
        });
    </script>
}